import { callGithubApi, getGithubQuery } from "./api/githubApi.js";
import { PROVIDER } from "./consts.js";
import { parseVulnerabilityData } from "./controllers/scanController.js";

export const fetchVulnerabilities = async (ecosystem, packageName) => {
    const query = getGithubQuery(ecosystem, packageName);
    const vulnerabilityData = await callGithubApi(query);
    console.log({vulnerabilityData});
    const parsedVulnerabilities = parseVulnerabilityData(vulnerabilityData, PROVIDER.githubApi);
    return parsedVulnerabilities;
    //validate response
  };